\chapter{Methodology}
\label{sec:methodology}

\section{Formulation of the ILP problem}

\begin{definition}[Source entity]

\end{definition}
\begin{definition}[Target candidate]

\end{definition}

\begin{align}
     & \argmax\limits_x \sum\limits_{(\src{p}, \tgt{p}) \in S \times T} c_{\src{p}, \tgt{p}} x_{\src{p}, \tgt{p}}                                                                      \\
     & \text{subject to} \notag                                                                                                                                                        \\
     & \sum\limits_{\tgt{p} \in T} x_{\src{p}, \tgt{p}} \lessgtr n_{proj}                                         & \forall \src{p} \in S                                              \\
     & x_{\src{p_1}, \tgt{p_1}} + x_{\src{p_2}, \tgt{p_2}} \leq 1                                                 & \forall (\src{p_1}, \src{p_2}, \tgt{p_1}, \tgt{p_2}) \in \hat{\Pi} \\
     & x_{\src{p}, \tgt{p}} \in \{ 0, 1 \}                                                                        & \forall (\src{p}, \tgt{p}) \in S \times T
\end{align}

\begin{figure*}[t]
    \centering
    \begin{tikzpicture}[node distance=-0.1,
            every node/.style={text centered,
                    text height=2ex,
                    text depth=.25ex,
                },
            loc/.style={fill=orange!30, rounded rectangle, label={[anchor=center,font=\tiny\bfseries\sffamily]above:#1-LOC}},
            per/.style={fill=green!30, rounded rectangle, label={[anchor=center,font=\tiny\bfseries\sffamily]above:#1-PER}},
            cand/.style={fill=blue!30, rounded rectangle},]

        \node[per={B}, rounded rectangle east arc=none](George_src){George};
        \node[per={I}, rounded rectangle west arc=none, right=of George_src](Washington_src){Washington};
        \node[right=of Washington_src](is_src){is};
        \node[right=of is_src](the_src){the};
        \node[right=of the_src](first_src){first};
        \node[right=of first_src](president_src){president};
        \node[right=of president_src](of_src){of};
        \node[right=of of_src](the_src){the};
        \node[loc={B}, rounded rectangle east arc=none, right=of the_src](United_src){United};
        \node[loc={I}, rounded rectangle west arc=none, right=of United_src](States_src){States};

        \node[cand, rounded rectangle east arc=none, below=of George_src, yshift=-1.5cm](George_tgt){George};
        \node[cand, rounded rectangle west arc=none, right=of George_tgt](Washington_tgt){Washington};
        \node[right=of Washington_tgt](ist_tgt){ist};
        \node[right=of ist_tgt](der_tgt){die};
        \node[right=of der_tgt](erste_tgt){erste};
        \node[right=of erste_tgt](president_tgt){PrÃ¤sident};
        \node[right=of president_tgt](der_tgt){der};
        \node[cand, rounded rectangle east arc=none, right=of der_tgt](Vereinigten_tgt){Vereinigten};
        \node[cand, rounded rectangle west arc=none, right=of Vereinigten_tgt](Staaten_tgt){Staaten};

        \node[text=gray, font=\scriptsize, above=of first_src, yshift=0.2cm, xshift=0.2cm](source){Source labeled sentence};
        \node[text=gray, font=\scriptsize, below=of source, yshift=-3cm]{Original sentence with extracted candidates};

        \draw[->] (George_src.south east) -- node[left]{\(c_{11}\)} (George_tgt.north east);
        \draw[->] (United_src.south east) -- node[right]{\(c_{22}\)} (Vereinigten_tgt.north east);
        \draw[->] (George_src.south east) -- node[above left, yshift=0.1cm, xshift=-0.2cm]{\(c_{12}\)} (Vereinigten_tgt.north east);
        \draw[->] (United_src.south east) -- node[below left]{\(c_{21}\)} (George_tgt.north east);
    \end{tikzpicture}
    \caption{Illustration of the proposed idea of matching source entities and candidates in the target sentence}
    \label{fig:cand_matching}
\end{figure*}

\begin{theorem}
    The relation of overlapping is not transitive.
\end{theorem}
\begin{proof}
    Trust me!
\end{proof}

\begin{corollary}
    We can not simplify constraints too much
\end{corollary}

merge some constraints
\begin{theorem}
    Merged constr and original are equivalent
\end{theorem}
\begin{proof}
    Trust me!
\end{proof}

\begin{equation}
    \begin{aligned}
         & \argmax\limits_x \sum\limits_{(\src{p}, \tgt{p}) \in S \times T} c_{\src{p}, \tgt{p}} x_{\src{p}, \tgt{p}}                                                                                                                   \\
         & \text{subject to} \notag                                                                                                                                                                                                     \\
         & \sum\limits_{\tgt{p} \in T} x_{\src{p}, \tgt{p}} \lessgtr n_{proj}                                         & \forall \src{p} \in S                                                                                           \\
         & \sum\limits_{\src{p} \in S} (x_{\src{p}, \tgt{p_1}} + x_{\src{p}, \tgt{p_2}}) \leq 1                       & \forall (\tgt{p_1}, \tgt{p_2}) \in \Pi                                                                          \\
         & \sum\limits_{\src{p} \in S} x_{\src{p}, \tgt{p}} \leq 1                                                    & \forall \tgt{p} \in T | \nexists \tgt{p_2} \in T: \tgt{p} \neq \tgt{p_2}, \tgt{p} \cap \tgt{p_2} \neq \emptyset \\
         & x_{\src{p}, \tgt{p}} \in \{ 0, 1 \}                                                                        & \forall (\src{p}, \tgt{p}) \in S \times T
    \end{aligned}
\end{equation}

\section{Candidates extraction}
n-grams

T5, LLM, high recall NER

\section{Matching score}
\subsection{Alignment-based}

\begin{equation} \label{eq:align_cost}
    c_{\src{p}, \tgt{p}}
\end{equation}

shrink candidate set + prove

\begin{lemma}
    If append unaligned word to a candidate cost will be smaller
\end{lemma}
\begin{proof}
    Trust me!
\end{proof}

\begin{theorem}
    Can remove candidates outside left and right most aligned words
\end{theorem}
\begin{proof}
    Trust me!
\end{proof}

\subsection{NER model-based}

model transfer for cand eval

\begin{equation} \label{eq:ner_cost}
    c_{\src{p}, \tgt{p}} =
\end{equation}

\subsection{Translation score-based}

nmtscore
\begin{equation} \label{eq:nmt_cost}
    c_{\src{p}, \tgt{p}}
\end{equation}

\subsection{Fused score}

ner score without classes (max over all)

weighted sum of scores
\begin{equation} \label{eq:fused_cost}
    c_{\src{p}, \tgt{p}}
\end{equation}

\section{Solution of the ILP problem}

greedy algorithm
\begin{algorithm}
    \caption{Greedy algorithm for the proposed ILP problem} \label{alg:ilp_greedy}
\end{algorithm}